<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Performance: Resource Hints -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<!-- Performance: Resource Hints -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
    // PRODUCTION BACKEND CONFIG
    // ============================================
    // TODO: Replace demo config with production:
    // 1. Option A: Use Supabase Real-time (recommended)
    //    - See PRODUCTION-GAME-BACKEND-SETUP.md
    // 2. Option B: Use Production Firebase
    //    - Create Firebase project
    //    - Get production keys
    //    - Replace config below
    // ============================================
const firebaseConfig = {
apiKey: "AIzaSyBvK_vZ3vXj5k5L0Qp6X9K5Z6Yq8L0A5B0",
authDomain: "conflict-cards.firebaseapp.com",
databaseURL: "https://conflict-cards-default-rtdb.firebaseio.com",
projectId: "conflict-cards"
};
let firebaseApp = null;
try {
if (!firebase.apps.length) firebaseApp = firebase.initializeApp(firebaseConfig);
} catch (error) {
            console.warn('Firebase init failed:', error);
}
class GameRoom {
constructor(roomCode, multiDevice = false) {
this.roomCode = roomCode;
this.multiDevice = multiDevice && firebaseApp !== null;
this.storageKey = `conflict-cards-${roomCode}`;
if (this.multiDevice) {
this.dbRef = firebase.database().ref(`rooms/${roomCode}`);
}
}
async getState() {
if (this.multiDevice) {
const snapshot = await this.dbRef.once('value');
return snapshot.val();
}
const data = localStorage.getItem(this.storageKey);
return data ? JSON.parse(data) : null;
}
async setState(state) {
if (this.multiDevice) {
await this.dbRef.set(state);
} else {
localStorage.setItem(this.storageKey, JSON.stringify(state));
window.dispatchEvent(new Event('storage'));
}
}
subscribe(callback) {
if (this.multiDevice) {
this.dbRef.on('value', (snapshot) => callback(snapshot.val()));
return () => this.dbRef.off('value');
} else {
const handler = () => {
const data = localStorage.getItem(this.storageKey);
callback(data ? JSON.parse(data) : null);
};
window.addEventListener('storage', handler);
return () => window.removeEventListener('storage', handler);
}
}
}
function ConflictCards() {
const [screen, setScreen] = useState('mode-select');
const [gameMode, setGameMode] = useState(null);
const [roomCode, setRoomCode] = useState('');
const [myName, setMyName] = useState('');
const [players, setPlayers] = useState([]);
const [judgeIndex, setJudgeIndex] = useState(0);
const [playerHands, setPlayerHands] = useState({});
const [blackCard, setBlackCard] = useState(null);
const [submissions, setSubmissions] = useState({});
const [scores, setScores] = useState({});
const [round, setRound] = useState(0);
const [usedBlackCards, setUsedBlackCards] = useState([]);
const [usedWhiteCards, setUsedWhiteCards] = useState([]);
const [showWinner, setShowWinner] = useState(false);
const [roundWinner, setRoundWinner] = useState(null);
const [sbirBonus, setSbirBonus] = useState(false);
const roomRef = useRef(null);
useEffect(() => {
if (!roomCode || screen === 'mode-select') return;
const room = new GameRoom(roomCode, gameMode === 'multi-device');
roomRef.current = room;
const unsubscribe = room.subscribe((state) => {
if (state) {
setPlayers(state.players || []);
setJudgeIndex(state.judgeIndex || 0);
setPlayerHands(state.playerHands || {});
setBlackCard(state.blackCard || null);
setSubmissions(state.submissions || {});
setScores(state.scores || {});
setRound(state.round || 0);
setUsedBlackCards(state.usedBlackCards || []);
setUsedWhiteCards(state.usedWhiteCards || []);
if (state.screen) setScreen(state.screen);
}
});
room.getState().then(state => {
if (!state) {
room.setState({
players: [],
judgeIndex: 0,
playerHands: {},
scores: {},
round: 0,
usedBlackCards: [],
usedWhiteCards: [],
screen: 'lobby'
});
}
});
return unsubscribe;
}, [roomCode, gameMode]);
const updateRoom = async (updates) => {
if (!roomRef.current) return;
const state = await roomRef.current.getState();
await roomRef.current.setState({ ...state, ...updates });
};
const selectMode = (mode) => {
setGameMode(mode);
setScreen('lobby');
const code = Math.random().toString(36).substring(2, 8).toUpperCase();
setRoomCode(code);
};
const addPlayer = async (name) => {
if (!name.trim() || !roomRef.current) return;
const state = await roomRef.current.getState();
if (state.players.some(p => p.name === name)) {
alert('Name taken!');
return;
}
const newPlayer = { name, id: Date.now() };
await updateRoom({
players: [...state.players, newPlayer],
scores: { ...state.scores, [name]: 0 }
});
setMyName(name);
};
const dealCards = () => {
const hands = {};
let availableCards = [...WHITE_CARDS];
players.forEach(player => {
hands[player.name] = [];
for (let i = 0; i < 10; i++) {
if (availableCards.length === 0) availableCards = [...WHITE_CARDS];
const index = Math.floor(Math.random() * availableCards.length);
hands[player.name].push(availableCards[index]);
availableCards.splice(index, 1);
}
});
return hands;
};
const startGame = async () => {
const state = await roomRef.current.getState();
if (state.players.length < 4) {
alert('Need at least 4 players!');
return;
}
const hands = dealCards();
await updateRoom({
screen: 'game',
round: 1,
judgeIndex: 0,
playerHands: hands
});
drawBlackCard();
};
const drawBlackCard = async () => {
const state = await roomRef.current.getState();
const available = BLACK_CARDS.filter((_, i) => !state.usedBlackCards.includes(i));
if (available.length === 0) {
await updateRoom({ screen: 'end' });
return;
}
const index = Math.floor(Math.random() * available.length);
const cardIndex = BLACK_CARDS.indexOf(available[index]);
await updateRoom({
blackCard: available[index],
usedBlackCards: [...state.usedBlackCards, cardIndex],
submissions: {}
});
};
const submitCard = async (card) => {
const state = await roomRef.current.getState();
const newHand = state.playerHands[myName].filter(c => c !== card);
await updateRoom({
submissions: { ...state.submissions, [myName]: card },
playerHands: {
...state.playerHands,
[myName]: newHand
}
});
};
const pickWinner = async (winnerName) => {
const state = await roomRef.current.getState();
const points = sbirBonus ? 2 : 1;
setRoundWinner(winnerName);
setShowWinner(true);
setTimeout(async () => {
setShowWinner(false);
setSbirBonus(false);
const newScores = { ...state.scores };
newScores[winnerName] = (newScores[winnerName] || 0) + points;
                    // Check win condition
if (newScores[winnerName] >= 7 || state.round >= 15) {
await updateRoom({ scores: newScores, screen: 'end' });
return;
}
                    // Next round
const newJudgeIndex = (state.judgeIndex + 1) % state.players.length;
const newRound = state.round + 1;
                    // Refill hands
const newHands = { ...state.playerHands };
Object.keys(newHands).forEach(name => {
while (newHands[name].length < 10) {
const availableCards = WHITE_CARDS.filter(c => !newHands[name].includes(c));
if (availableCards.length === 0) break;
const randomCard = availableCards[Math.floor(Math.random() * availableCards.length)];
newHands[name].push(randomCard);
}
});
await updateRoom({
scores: newScores,
judgeIndex: newJudgeIndex,
round: newRound,
playerHands: newHands
});
drawBlackCard();
}, 3000);
};
const resetGame = () => {
setScreen('mode-select');
setGameMode(null);
setMyName('');
setRoomCode('');
};
const judge = players[judgeIndex];
const isJudge = judge?.name === myName;
const myHand = playerHands[myName] || [];
const hasSubmitted = submissions[myName] !== undefined;
const allSubmitted = Object.keys(submissions).length === players.length - 1;
            // Mode Select Screen
if (screen === 'mode-select') {
return (
<div className="min-h-screen flex items-center justify-center p-4">
<div className="max-w-2xl w-full">
<div className="bg-white/10 backdrop-blur-lg rounded-3xl p-12 shadow-2xl border border-white/20 fade-in">
<h1 className="text-5xl font-bold text-white mb-4 text-center">
<svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-briefcase"></use></svg> Conflict Cards
</h1>
<p className="text-white/80 text-center mb-12 text-lg">
Workplace Edition - Against Harmony
</p>
<div className="space-y-6">
<button
onClick={() = aria-label="className="w-full bg-gradient-to-r from-purple-50"> selectMode('pass-play')}
className="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-6 rounded-2xl font-bold text-xl hover:shadow-2xl transform hover:scale-105 transition"
>
<div className="text-3xl mb-2"><svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-hand-raised"></use></svg></div>
Pass & Play
</button>
<button
onClick={() = aria-label="className="w-full bg-gradient-to-r from-blue-500"> selectMode('multi-device')}
className="w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-6 rounded-2xl font-bold text-xl hover:shadow-2xl transform hover:scale-105 transition"
>
<div className="text-3xl mb-2"><svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-globe-alt"></use></svg></div>
Multi-Device
</button>
</div>
</div>
</div>
</div>
);
}
            // Lobby Screen
if (screen === 'lobby') {
return (
<div className="min-h-screen flex items-center justify-center p-4">
<div className="max-w-2xl w-full">
<div className="bg-white/10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl border border-white/20 fade-in">
<div className="text-center mb-8">
<h2 className="text-3xl font-bold text-white mb-4">Game Lobby</h2>
<div className="inline-block bg-gradient-to-r from-purple-500/30 to-pink-500/30 rounded-lg px-6 py-3 border border-purple-500/50">
<p className="text-white/60 text-sm">Room Code</p>
<p className="text-4xl font-mono font-bold text-white">{roomCode}</p>
</div>
</div>
{!myName ? (
<input
type="text"
placeholder="Enter your name"
className="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-purple-500 mb-6"
onKeyPress={(e) => {
if (e.key === 'Enter') {
addPlayer(e.target.value);
e.target.value = '';
}
}}
/>
) : (
<>
<div className="mb-6">
<h3 className="text-white font-bold mb-4">Players ({players.length}/10)</h3>
<div className="space-y-2">
{players.map(player => (
<div key={player.id} className="bg-white/5 rounded-lg p-3 flex justify-between">
<span className="text-white">{player.name}</span>
{player.name === myName && <span className="text-purple-400">(You)</span>}
</div>
))}
</div>
</div>
{players.length >= 4 && players[0]?.name === myName && (
<button
onClick={startGame}
className="w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white px-8 py-4 rounded-xl font-bold text-xl hover:shadow-lg transform hover:scale-105 transition pulse-animation"
aria-label="Start game">
Start Game
</button>
)}
{players.length < 4 && (
<p className="text-white/60 text-center">Need {4 - players.length} more players</p>
)}
</>
)}
<button onClick={() = aria-label="‚Üê Back"> setScreen('mode-select')} className="w-full mt-4 text-white/60 hover:text-white">
‚Üê Back
</button>
</div>
</div>
</div>
);
}
            // Game Screen
if (screen === 'game') {
return (
<div className="min-h-screen p-4">
<div className="max-w-6xl mx-auto">
                            {/* Header */}
<div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-6">
<div className="flex justify-between items-center">
<div>
<h2 className="text-2xl font-bold text-white">Round {round}</h2>
<p className="text-white/60">Judge: {judge?.name}</p>
</div>
<div className="text-right">
<p className="text-white/60 text-sm">Room: {roomCode}</p>
<p className="text-white text-sm">Target: 7 points</p>
</div>
</div>
</div>
<div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                {/* Main Area */}
<div className="lg:col-span-2 space-y-6">
                                    {/* Black Card */}
{blackCard && (
<div className="bg-black border-4 border-white rounded-2xl p-8 shadow-2xl">
<p className="text-white text-2xl font-bold text-center">
{blackCard}
</p>
</div>
)}
                                    {/* Judge View */}
{isJudge && allSubmitted && (
<div className="space-y-4">
<div className="flex items-center gap-4 mb-4">
<label className="flex items-center gap-2 text-white">
<input
type="checkbox"
checked={sbirBonus}
onChange={(e) => setSbirBonus(e.target.checked)}
className="w-5 h-5"
/>
<span>SBIR Bonus (+2 points instead of 1)</span>
</label>
</div>
<p className="text-white text-center font-bold mb-4">Pick the Winner:</p>
{Object.entries(submissions).map(([name, card], i) => (
<button
key={i}
onClick={() = aria-label="className="w-full bg-white rounded-xl p-6 text-le"> pickWinner(name)}
className="w-full bg-white rounded-xl p-6 text-left hover:bg-purple-100 transition transform hover:scale-105 shadow-lg"
>
<p className="text-gray-800 text-lg">{card}</p>
</button>
))}
</div>
)}
                                    {/* Player View */}
{!isJudge && (
<div>
{!hasSubmitted ? (
<div>
<p className="text-white text-center mb-4 font-bold">Choose Your Card:</p>
<div className="grid grid-cols-1 md:grid-cols-2 gap-4">
{myHand.map((card, i) => (
<button
key={i}
onClick={() = aria-label="className="bg-white rounded-xl p-4 text-left hove"> submitCard(card)}
className="bg-white rounded-xl p-4 text-left hover:bg-purple-100 transition transform hover:scale-105 shadow-lg"
>
<p className="text-gray-800">{card}</p>
</button>
))}
</div>
</div>
) : (
<p className="text-green-400 text-center text-xl">
<svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-check"></use></svg> Card submitted! Waiting for judge...
</p>
)}
</div>
)}
{isJudge && !allSubmitted && (
<p className="text-white/60 text-center text-xl">
Waiting for players to submit cards...
<br />
<span className="text-sm">({Object.keys(submissions).length}/{players.length - 1})</span>
</p>
)}
</div>
                                {/* Scoreboard */}
<div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6">
<h3 className="text-xl font-bold text-white mb-4">Scores</h3>
<div className="space-y-2">
{players
.sort((a, b) => (scores[b.name] || 0) - (scores[a.name] || 0))
.map(player => (
<div
key={player.id}
className={`p-3 rounded-lg ${
player.name === judge?.name ? 'bg-yellow-500/30 border border-yellow-500' : 'bg-white/5'
}`}
>
<div className="flex justify-between items-center">
<div>
<span className="text-white">{player.name}</span>
{player.name === myName && <span className="ml-2 text-purple-400 text-xs">(You)</span>}
{player.name === judge?.name && <span className="ml-2 text-yellow-400 text-xs">üë®‚Äç<svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-scale"></use></svg></span>}
</div>
<span className="text-2xl font-bold text-purple-400">
{scores[player.name] || 0}
</span>
</div>
</div>
))}
</div>
<button onClick={resetGame} className="w-full mt-4 text-white/60 hover:text-white text-sm" aria-label="End Game">
End Game
</button>
</div>
</div>
</div>
                        {/* Winner Modal */}
{showWinner && (
<div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 fade-in">
<div className="bg-gradient-to-br from-purple-600 to-pink-600 rounded-3xl p-12 max-w-2xl shadow-2xl wiggle-animation">
<h2 className="text-5xl font-bold text-white text-center mb-8"><svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-trophy"></use></svg></h2>
<h3 className="text-3xl font-bold text-white text-center mb-4">Round Winner!</h3>
<p className="text-4xl font-bold text-white text-center">{roundWinner}</p>
<p className="text-white/80 text-center mt-4">
+{sbirBonus ? 2 : 1} point{sbirBonus ? 's' : ''}
{sbirBonus && <span className="ml-2"><svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-star"></use></svg> SBIR Bonus!</span>}
</p>
</div>
</div>
)}
</div>
);
}
            // End Screen
if (screen === 'end') {
const sorted = [...players].sort((a, b) => (scores[b.name] || 0) - (scores[a.name] || 0));
const winner = sorted[0];
return (
<div className="min-h-screen flex items-center justify-center p-4">
<div className="max-w-4xl w-full">
<div className="bg-white/10 backdrop-blur-lg rounded-3xl p-12 shadow-2xl border border-white/20">
<h1 className="text-6xl text-center mb-8"><svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-trophy"></use></svg></h1>
<h2 className="text-4xl font-bold text-white text-center mb-8">Game Over!</h2>
<div className="bg-gradient-to-r from-purple-500/30 to-pink-500/30 rounded-xl p-8 mb-8 border border-purple-500/50 text-center">
<p className="text-white/80 mb-2">Winner</p>
<p className="text-5xl font-bold text-white">{winner?.name}</p>
<p className="text-3xl text-purple-400 mt-4">{scores[winner?.name]} points</p>
</div>
<div className="space-y-3 mb-8">
<h3 className="text-2xl font-bold text-white text-center mb-4">Final Standings</h3>
{sorted.map((player, i) => (
<div key={player.id} className="bg-white/5 rounded-lg p-4 flex justify-between">
<span className="text-white">#{i + 1} {player.name}</span>
<span className="text-2xl font-bold text-purple-400">{scores[player.name] || 0}</span>
</div>
))}
</div>
<button
onClick={resetGame}
className="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white px-12 py-4 rounded-xl font-bold text-xl hover:shadow-lg transform hover:scale-105 transition"
aria-label="Play Again">
Play Again
</button>
</div>
</div>
</div>
);
}
return null;
}
ReactDOM.render(<ConflictCards />, document.getElementById('root'));
</script>
<!-- Performance Optimizer - Load First -->
<script src="../../../js/performance-optimizer.min.js"></script>
<!-- TAP-IN Utilities -->
<script src="../../../js/shared-utilities.js"></script>
<script src="../../../js/global-error-handler.min.js"></script>
<script src="../../../js/storage-health.min.js"></script>
<!-- TAP-IN Core Modules -->
<script src="../../../js/meta-tags-manager.js"></script>
<script src="../../../js/achievement-badges.js"></script>
<script src="../../../js/structured-data.js"></script>
<!-- PWA Service Worker Registration -->
<script>
if ('serviceWorker' in navigator) {
window.addEventListener('load', function() {
navigator.serviceWorker.register('/service-worker.js')
.then(function(registration) {
//                         console.log('Service Worker registered:', registration.scope);
                        // Check for updates
registration.addEventListener('updatefound', function() {
const newWorker = registration.installing;
newWorker.addEventListener('statechange', function() {
if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New service worker available
                                    console.log('New service worker available');
}
});
});
})
.catch(function(error) {
                        // Silent fail - not critical
});
});
}
</script>
<script src="../../../js/pwa-instal-prompt.js"></script>

    <!-- Navigation back to Gym -->
    <div style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
        <a href="../../gym/gym-dashboard.html" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 12px 20px; background: linear-gradient(135deg, #1a365d 0%, #7c3aed 100%); color: white; text-decoration: none; border-radius: 12px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: transform 0.2s;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back to Gym
        </a>
    </div>

</body>
</html>
=======
<title>Conflict Cards - Feedback Training Game | Tap-In</title>
<meta name="description" content="Cards Against Humanity meets SBIR feedback training. Practice professional vs. toxic responses to workplace conflicts. From Tap-In Leadership Academy.">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: 'Inter', sans-serif;
background: linear-gradient(135deg, var(--bg-primary) 0%, #7c3aed 100%);
min-height: 100vh;
padding: 20px;
}
.container {
max-width: 900px;
margin: 0 auto;
}
.back-link {
display: inline-block;
color: white;
text-decoration: none;
font-weight: 600;
margin-bottom: 20px;
padding: 10px 20px;
background: rgba(255, 255, 255, 0.2);
border-radius: 10px;
}
.game-screen {
display: none;
}
.game-screen.active {
display: block;
}
        /* Setup */
.setup-card {
background: white;
border-radius: 20px;
padding: 60px 40px;
box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
text-align: center;
}
.game-logo {
font-size: 80px;
margin-bottom: 20px;
}
.game-title {
font-size: 48px;
font-weight: 800;
color: var(--bg-primary);
margin-bottom: 15px;
}
.game-subtitle {
font-size: 18px;
color: var(--text-muted);
margin-bottom: 40px;
}
.input-group {
margin-bottom: 30px;
text-align: left;
}
.input-group label {
display: block;
font-weight: 600;
color: var(--bg-primary);
margin-bottom: 10px;
}
.input-group input {
width: 100%;
padding: 15px;
border: 2px solid var(--border-light);
border-radius: 10px;
font-size: 16px;
}
.player-tags {
display: flex;
flex-wrap: wrap;
gap: 10px;
margin-top: 15px;
}
.player-tag {
background: #ede9fe;
color: #5b21b6;
padding: 8px 16px;
border-radius: 20px;
font-weight: 600;
display: flex;
align-items: center;
gap: 8px;
}
.remove-player {
cursor: pointer;
font-weight: bold;
color: #991b1b;
}
.btn {
padding: 16px 40px;
border: none;
border-radius: 12px;
font-size: 18px;
font-weight: 700;
cursor: pointer;
transition: all 0.3s ease;
}
.btn-primary {
background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
color: white;
}
.btn-primary:disabled {
opacity: 0.5;
cursor: not-allowed;
}
        /* Game Screen */
.game-card {
background: white;
border-radius: 20px;
padding: 40px;
box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
}
.round-header {
text-align: center;
margin-bottom: 30px;
}
.round-number {
font-size: 16px;
color: var(--text-muted);
font-weight: 600;
margin-bottom: 10px;
}
.judge-name {
font-size: 28px;
font-weight: 800;
color: #7c3aed;
}
        /* Black Card (Conflict Scenario) */
.black-card {
background: linear-gradient(135deg, var(--belt-black) 0%, #111827 100%);
border: 4px solid #374151;
border-radius: 15px;
padding: 40px;
margin-bottom: 30px;
min-height: 200px;
display: flex;
align-items: center;
justify-content: center;
}
.black-card-text {
font-size: 24px;
font-weight: 700;
color: white;
text-align: center;
line-height: 1.6;
}
        /* White Cards (Responses) */
.hand-section {
margin-top: 30px;
}
.hand-title {
font-size: 20px;
font-weight: 700;
color: var(--bg-primary);
margin-bottom: 15px;
}
.hand-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 15px;
}
.white-card {
background: white;
border: 3px solid var(--border-light);
border-radius: 12px;
padding: 20px;
cursor: pointer;
transition: all 0.3s ease;
min-height: 120px;
display: flex;
align-items: center;
justify-content: center;
}
.white-card:hover {
transform: translateY(-5px);
border-color: #7c3aed;
box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
}
.white-card.selected {
background: #ede9fe;
border-color: #7c3aed;
transform: translateY(-5px);
}
.white-card-text {
font-size: 16px;
font-weight: 600;
color: var(--bg-primary);
text-align: center;
line-height: 1.4;
}
        /* Judge View */
.submissions-section {
margin-top: 30px;
}
.submission-card {
background: #f1f5f9;
border-radius: 12px;
padding: 25px;
margin-bottom: 20px;
cursor: pointer;
transition: all 0.3s ease;
border: 3px solid transparent;
}
.submission-card:hover {
background: #ede9fe;
border-color: #7c3aed;
transform: translateX(5px);
}
.submission-text {
font-size: 18px;
font-weight: 600;
color: var(--bg-primary);
margin-bottom: 15px;
}
.sbir-checkbox {
display: flex;
align-items: center;
gap: 10px;
}
.sbir-checkbox input {
width: 24px;
height: 24px;
cursor: pointer;
}
.sbir-checkbox label {
font-size: 14px;
color: var(--text-muted);
cursor: pointer;
}
        /* Score Display */
.score-section {
background: #f1f5f9;
border-radius: 12px;
padding: 20px;
margin-top: 30px;
}
.score-title {
font-size: 18px;
font-weight: 700;
color: var(--bg-primary);
margin-bottom: 15px;
}
.player-scores {
display: grid;
gap: 10px;
}
.player-score-row {
display: flex;
justify-content: space-between;
align-items: center;
background: white;
padding: 12px 20px;
border-radius: 8px;
}
.player-score-row.leader {
background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
}
.player-name {
font-weight: 600;
color: var(--bg-primary);
}
.points {
font-size: 28px;
font-weight: 800;
color: #7c3aed;
}
        /* Results */
.results-card {
background: white;
border-radius: 20px;
padding: 40px;
box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
text-align: center;
}
.winner-badge {
font-size: 72px;
margin-bottom: 20px;
}
.winner-name {
font-size: 48px;
font-weight: 900;
color: var(--bg-primary);
margin-bottom: 40px;
}
@media (max-width: 768px) {
.hand-grid {
grid-template-columns: 1fr;
}
.black-card-text {
font-size: 20px;
}
}
</style>
<script src="/js/core/dom.js" type="module"></script>
<script src="/js/core/progress.js" type="module"></script>
<script src="/js/core/results.js" type="module"></script>
<script src="/js/core/quiz.js" type="module"></script>
<script src="/js/core/lessons.js" type="module"></script>
<link rel="stylesheet" href="/css/variables.css">
</head>
<body>
<main role="main"><div class="container">
<a href="leadership-games.html" class="back-link">‚Üê Back to Games</a>
<!-- Setup -->
<div id="setupScreen" class="game-screen active">
<div class="setup-card">
<div class="game-logo"><svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-briefcase"></use></svg></div>
<h1 class="game-title">Conflict Cards</h1>
<p class="game-subtitle">Cards Against Humanity meets SBIR feedback training</p>
<div class="input-group">
<label>Add Players (4-10 players)</label>
<input type="text" id="playerInput" placeholder="Enter player name..." onkeypress="if(event.key==='Enter') addPlayer()">
<button onclick="addPlayer()" class="btn btn-primary" style="margin-top: 10px; width: 100%;" aria-label="Primary action">Add Player</button>
<div id="playerTags" class="player-tags"></div>
</div>
<button onclick="startGame()" id="startButton" class="btn btn-primary" disabled aria-label="Start">
Start Game
</button>
<div style="margin-top: 40px; padding-top: 40px; border-top: 2px solid var(--border-light);">
<h3 style="font-size: 20px; font-weight: 700; color: var(--bg-primary); margin-bottom: 15px;">How to Play:</h3>
<ol style="text-align: left; color: #475569; line-height: 1.8; padding-left: 20px;">
<li><strong>Black card</strong> - Judge reads workplace conflict scenario</li>
<li><strong>Submit responses</strong> - Others play white cards (pass device)</li>
<li><strong>Judge picks winner</strong> - Best response gets points</li>
<li><strong>SBIR BONUS</strong> - If winner used proper feedback (Situation-Behavior-Impact-Request) = 2 points vs 1</li>
<li><strong>Rotate judge</strong> - Next player becomes judge</li>
<li><strong>First to 7 points wins!</strong></li>
</ol>
</div>
</div>
</div>
<!-- Player Submit Card -->
<div id="submitScreen" class="game-screen">
<div class="game-card">
<div class="round-header">
<div class="round-number">Round <span id="roundNum">1</span></div>
<div style="font-size: 20px; font-weight: 700; color: var(--text-muted); margin-top: 10px;">
<span id="currentPlayer">Player</span>'s Turn
</div>
</div>
<div class="black-card">
<div class="black-card-text" id="blackCardText">Loading scenario...</div>
</div>
<div class="hand-section">
<div class="hand-title">Select Your Response:</div>
<div class="hand-grid" id="handGrid"></div>
</div>
<button onclick="submitCard()" id="submitButton" class="btn btn-primary" style="width: 100%; margin-top: 20px;" disabled aria-label="Submit">
Submit Response
</button>
</div>
</div>
<!-- Judge Pick Winner -->
<div id="judgeScreen" class="game-screen">
<div class="game-card">
<div class="round-header">
<div class="round-number">Round <span id="judgeRoundNum">1</span></div>
<div class="judge-name"><span id="judgeName">Judge</span> Picks the Winner</div>
</div>
<div class="black-card">
<div class="black-card-text" id="judgeBlackCard">Scenario...</div>
</div>
<div class="submissions-section">
<div class="hand-title">All Responses:</div>
<div id="submissionsGrid"></div>
</div>
<div class="score-section">
<div class="score-title">Current Scores</div>
<div class="player-scores" id="scoreDisplay"></div>
</div>
</div>
</div>
<!-- Results -->
<div id="resultsScreen" class="game-screen">
<div class="results-card">
<div class="winner-badge"><svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-trophy"></use></svg></div>
<h2 style="font-size: 36px; font-weight: 700; color: var(--bg-primary); margin-bottom: 20px;">
Feedback Master
</h2>
<div class="winner-name" id="winnerName">Player Name</div>
<div class="player-scores" id="finalScores"></div>
<div style="display: flex; gap: 15px; margin-top: 40px;">
<button onclick="location.reload()" class="btn btn-primary" style="flex: 1;" aria-label="Primary action">
Play Again
</button>
<button onclick="location.href='leadership-games.html'" class="btn btn-primary" style="flex: 1;" aria-label="Navigate">
More Games
</button>
</div>
</div>
</div>
</div>
<script>
        // Mock cards database
const blackCards = [
"Your teammate keeps missing deadlines. How do you address it?",
"Someone takes credit for your idea in a meeting. What do you say?",
"A colleague's work quality has dropped. How do you bring it up?",
"Your boss micromanages everything you do. How do you handle it?",
"Someone interrupts you constantly in meetings. Your response?",
"A team member's negative attitude is affecting morale. What do you do?",
"You disagree with your manager's decision. How do you communicate it?",
"Someone gives you harsh criticism publicly. How do you respond?",
"Your direct report asks for feedback. What's your approach?",
"A peer makes a mistake that affects your work. How do you address it?"
];
const whiteCards = [
"I noticed in yesterday's meeting, when you spoke over me three times, it made me feel unheard. Could we discuss turn-taking?",
"Can we talk about the deadline situation? I want to understand what's blocking you.",
"Your recent deliverables seem different from before. Is everything okay? How can I support?",
"I've observed you cutting people off. It impacts team dynamics. Let's find a solution.",
"When you took ownership of that idea without mentioning my contribution, it felt dismissive. Can we align on credit?",
"Let's schedule time to discuss workload and autonomy. I value independence.",
"I appreciate the feedback. Can you help me understand the specifics so I can improve?",
"Your tone in that email came across harsh. Could we discuss communication preferences?",
"Just do your job better.",
"Maybe try not being terrible at your job?",
"That's a stupid way to do it.",
"You're always screwing things up.",
"Why can't you just be professional?",
"Figure it out yourself.",
"Not my problem.",
"Can you please stop being incompetent?",
"I'm tired of your excuses.",
"You're wasting everyone's time.",
"Stop being so sensitive.",
"Whatever, I don't care."
];
        // Game state
let players = [];
let scores = {};
let hands = {};
let deck = [...whiteCards];
let currentJudge = 0;
let currentRound = 0;
let currentBlackCard = null;
let submissions = {};
let currentPlayerIndex = 0;
let selectedCard = null;
function addPlayer() {
const input = document.getElementById('playerInput');
const name = input.value.trim();
if (name && !players.includes(name)) {
players.push(name);
scores[name] = 0;
input.value = '';
updatePlayerTags();
updateStartButton();
}
}
function removePlayer(name) {
players = players.filter(p => p !== name);
delete scores[name];
updatePlayerTags();
updateStartButton();
}
function updatePlayerTags() {
const container = document.getElementById('playerTags');
safeSetInnerHTML(container, players.map(name => `
<div class="player-tag">
${name}
<span class="remove-player" onclick="removePlayer('${name}')">√ó</span>
</div>
`).join(''));
}
function updateStartButton() {
document.getElementById('startButton').disabled = players.length < 4;
}
function startGame() {
if (players.length < 4) {
alert('Need at least 4 players!');
return;
}
            // Deal initial hands
players.forEach(player => {
hands[player] = [];
for (let i = 0; i < 10; i++) {
drawCard(player);
}
});
nextRound();
}
function drawCard(player) {
if (deck.length === 0) {
deck = [...whiteCards]; // Reshuffle
}
const randomIndex = Math.floor(Math.random() * deck.length);
const card = deck.splice(randomIndex, 1)[0];
hands[player].push(card);
}
function nextRound() {
currentRound++;
            // Check for winner
const winner = Object.keys(scores).find(p => scores[p] >= 7);
if (winner) {
showWinner(winner);
return;
}
            // Get black card
currentBlackCard = blackCards[Math.floor(Math.random() * blackCards.length)];
            // Reset submissions
submissions = {};
currentPlayerIndex = 0;
selectedCard = null;
            // Start submission phase
nextPlayerSubmit();
}
function nextPlayerSubmit() {
const judgeName = players[currentJudge];
const nonJudgePlayers = players.filter(p => p !== judgeName);
if (currentPlayerIndex >= nonJudgePlayers.length) {
                // All submitted - move to judge screen
showJudgeScreen();
return;
}
const currentPlayer = nonJudgePlayers[currentPlayerIndex];
            // Update display
document.getElementById('roundNum').textContent = currentRound;
document.getElementById('currentPlayer').textContent = currentPlayer;
document.getElementById('blackCardText').textContent = currentBlackCard;
            // Show player's hand
const handGrid = document.getElementById('handGrid');
safeSetInnerHTML(handGrid, hands[currentPlayer].map((card, index) => `
<div class="white-card" onclick="selectCard(${index})">
<div class="white-card-text">${card}</div>
</div>
`).join(''));
document.getElementById('submitButton').disabled = true;
showScreen('submitScreen');
}
function selectCard(index) {
selectedCard = index;
document.querySelectorAll('.white-card').forEach((card, i) => {
if (i === index) {
card.classList.add('selected');
} else {
card.classList.remove('selected');
}
});
document.getElementById('submitButton').disabled = false;
}
function submitCard() {
if (selectedCard === null) return;
const judgeName = players[currentJudge];
const nonJudgePlayers = players.filter(p => p !== judgeName);
const currentPlayer = nonJudgePlayers[currentPlayerIndex];
            // Record submission
const card = hands[currentPlayer][selectedCard];
submissions[currentPlayer] = card;
            // Remove card from hand and draw new one
hands[currentPlayer].splice(selectedCard, 1);
drawCard(currentPlayer);
            // Next player
currentPlayerIndex++;
selectedCard = null;
nextPlayerSubmit();
}
function showJudgeScreen() {
const judgeName = players[currentJudge];
document.getElementById('judgeRoundNum').textContent = currentRound;
document.getElementById('judgeName').textContent = judgeName;
document.getElementById('judgeBlackCard').textContent = currentBlackCard;
            // Show all submissions
const submissionsGrid = document.getElementById('submissionsGrid');
safeSetInnerHTML(submissionsGrid, Object.keys(submissions).map(player => `
<div class="submission-card" onclick="pickWinner('${player}')">
<div class="submission-text">${submissions[player]}</div>
<div class="sbir-checkbox" onclick="event.stopPropagation()">
<input type="checkbox" id="sbir-${player}">
<label for="sbir-${player}">Used SBIR Feedback (+2 points vs +1)</label>
</div>
</div>
`).join(''));
updateScoreDisplay();
showScreen('judgeScreen');
}
function pickWinner(player) {
            // Check SBIR checkbox
const isSBIR = document.getElementById(`sbir-${player}`).checked;
const points = isSBIR ? 2 : 1;
scores[player] += points;
alert(`${player} wins! +${points} point${points > 1 ? 's' : ''} ${isSBIR ? '(SBIR Bonus!)' : ''}`);
            // Next judge
currentJudge = (currentJudge + 1) % players.length;
setTimeout(nextRound, 1000);
}
function updateScoreDisplay() {
const container = document.getElementById('scoreDisplay');
const sorted = [...players].sort((a, b) => scores[b] - scores[a]);
safeSetInnerHTML(container, sorted.map((player, index) => `
<div class="player-score-row ${index === 0 ? 'leader' : ''}">
<div class="player-name">${index === 0 ? '<svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-trophy"></use></svg> ' : ''}${player}</div>
<div class="points">${scores[player]}</div>
</div>
`).join(''));
}
function showWinner(winner) {
document.getElementById('winnerName').textContent = winner;
const sorted = [...players].sort((a, b) => scores[b] - scores[a]);
safeSetInnerHTML(document.getElementById('finalScores'), sorted.map((player, index) => `
<div class="player-score-row ${index === 0 ? 'leader' : ''}">
<div class="player-name">${index === 0 ? '<svg class="hero-icon hero-icon-md" aria-hidden="true"><use href="../../../icons/sprite.svg#icon-icon-trophy"></use></svg> ' : ''}${player}</div>
<div class="points">${scores[player]}</div>
</div>
`).join('');
showScreen('resultsScreen');
}
function showScreen(screenId) {
document.querySelectorAll('.game-screen').forEach(screen => {
screen.classList.remove('active');
});
document.getElementById(screenId).classList.add('active');
}
</script>
<!-- TAP-IN Utilities -->
<script src="../../../js/shared-utilities.js"></script>
<script src="../../../js/global-error-handler.min.js"></script>
<script src="../../../js/storage-health.min.js"></script>
<!-- Screen Reader Enhancements for Accessibility -->
<script src="../../../js/screen-reader-enhancements.js" defer></script>

    <!-- Navigation back to Gym -->
    <div style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
        <a href="../../gym/gym-dashboard.html" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 12px 20px; background: linear-gradient(135deg, #1a365d 0%, #7c3aed 100%); color: white; text-decoration: none; border-radius: 12px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: transform 0.2s;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back to Gym
        </a>
    </div>

</body>
</html>
>>>>>>> f82bb98a71dd8a9521785cc7a4d3d6198bde9727