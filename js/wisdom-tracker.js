(function(){'use strict';const isGerman=window.location.pathname.includes('-de.html')||window.location.pathname.includes('-de/')||localStorage.getItem('preferredLanguage')==='de';const wisdomMessagesDE={gentle:{title:"üèõÔ∏è Denk an das Orakel",message:"\"Nichts im √úberma√ü\"-Du trainierst seit 30 Minuten. Toller Fortschritt!",suggestion:"Zieh in Erw√§gung,eine 5-min√ºtige Pause einzulegen,damit das Gelernte sich setzen kann.",reward:null,xpBonus:0,breakDuration:5,canDismiss:true},moderate:{title:"üèõÔ∏è Weisheit aus Delphi",message:"\"Nichts im √úberma√ü\"-45 Minuten fokussiertes Lernen. Beeindruckende Hingabe.",suggestion:"Mach eine 10-min√ºtige Pause. Geh spazieren,atme,reflektiere √ºber das Gelernte.",reward:"+10 XP f√ºr achtsame Praxis",xpBonus:10,breakDuration:10,canDismiss:true},strong:{title:"üèõÔ∏è Aktive Erholung freigeschaltet",message:"\"Nichts im √úberma√ü\"-60 Minuten!Zeit f√ºr aktive Erholung.",suggestion:"Du hast+25 XP verdient und eine 15-min√ºtige gef√ºhrte Reflexion freigeschaltet.",reward:"+25 XP",xpBonus:25,breakDuration:15,canDismiss:true},hardcore:{title:"‚ö†Ô∏è Das Orakel spricht",message:"\"Nichts im √úberma√ü\"-90+Minuten √ºberschreitet gesundes Lernen.",suggestion:"Selbst Kampfk√ºnstler ruhen sich aus. Mach eine Pause. Das Training ist morgen noch da.",reward:"Keine XP-Strafe,aber Pause dringend empfohlen",xpBonus:0,breakDuration:20,canDismiss:true}};const wisdomUIDE={takeBreak:"Mach eine Pause",continueTraining:"Training fortsetzen",breakTaken:"üèõÔ∏è Weise Entscheidung. Ruhe ist Teil der Meisterschaft. Bis bald!",sessionPaused:"‚è∏Ô∏è Session pausiert. Dein Fortschritt ist gespeichert.",welcomeBack:"ü•ã Willkommen zur√ºck,Impact-Leader!Bereit f√ºr mehr Training?",xpAwarded:(xp)=>`‚ú®+${xp}XP f√ºr achtsame Praxis verdient!`,modalTitle:"Nichts im √úberma√ü",subtitle:"Antike Weisheit f√ºr moderne Meisterschaft",timerLabel:"Aktive Trainingszeit",minutes:"Min"};const wisdomMessagesEN={gentle:{title:"üèõÔ∏è Remember the Oracle",message:"\"Nothing in Excess\"-You've been training for 30 minutes. Great progress!",suggestion:"Consider taking a 5-minute break to let the learning settle.",reward:null,xpBonus:0,breakDuration:5,canDismiss:true},moderate:{title:"üèõÔ∏è Wisdom from Delphi",message:"\"Nothing in Excess\"-45 minutes of focused learning. Impressive dedication.",suggestion:"Take a 10-minute break. Walk,breathe,reflect on what you've learned.",reward:"+10 XP for mindful practice",xpBonus:10,breakDuration:10,canDismiss:true},strong:{title:"üèõÔ∏è Active Recovery Unlocked",message:"\"Nothing in Excess\"-60 minutes!Time for active recovery.",suggestion:"You've earned+25 XP and unlocked a 15-minute guided reflection.",reward:"+25 XP",xpBonus:25,breakDuration:15,canDismiss:true},hardcore:{title:"‚ö†Ô∏è The Oracle Speaks",message:"\"Nothing in Excess\"-90+minutes exceeds healthy learning.",suggestion:"Even martial artists rest. Take a break. The training will be here tomorrow.",reward:"No XP penalty,but break strongly recommended",xpBonus:0,breakDuration:20,canDismiss:true}};const wisdomUIEN={takeBreak:"Take a Break",continueTraining:"Continue Training",breakTaken:"üèõÔ∏è Wise choice. Rest is part of mastery. See you soon!",sessionPaused:"‚è∏Ô∏è Session paused. Your progress is saved.",welcomeBack:"ü•ã Welcome back!Ready for more training?",xpAwarded:(xp)=>`‚ú®+${xp}XP earned for mindful practice!`,modalTitle:"Nothing in Excess",subtitle:"Ancient wisdom for modern mastery",timerLabel:"Active Training Time",minutes:"min"};const messages=isGerman ? wisdomMessagesDE:wisdomMessagesEN;const ui=isGerman ? wisdomUIDE:wisdomUIEN;const THRESHOLDS={gentle:30,moderate:45,strong:60,hardcore:90};let sessionStartTime=null;let checkInterval=null;let lastNotificationLevel=null;let modalOpen=false;function init(){if(sessionStartTime)return;const storedStart=sessionStorage.getItem('wisdomSessionStart');if(storedStart){sessionStartTime=parseInt(storedStart);}else{sessionStartTime=Date.now();sessionStorage.setItem('wisdomSessionStart',sessionStartTime);}checkInterval=setInterval(checkSessionTime,60000);checkSessionTime(); }function checkSessionTime(){if(modalOpen)return;const sessionMinutes=getSessionMinutes();let currentLevel=null;if(sessionMinutes>=THRESHOLDS.hardcore){currentLevel='hardcore';}else if(sessionMinutes>=THRESHOLDS.strong){currentLevel='strong';}else if(sessionMinutes>=THRESHOLDS.moderate){currentLevel='moderate';}else if(sessionMinutes>=THRESHOLDS.gentle){currentLevel='gentle';}if(currentLevel&&currentLevel!==lastNotificationLevel){const dismissedLevels=JSON.parse(sessionStorage.getItem('wisdomDismissed')||'[]');if(!dismissedLevels.includes(currentLevel)){showWisdomModal(currentLevel);lastNotificationLevel=currentLevel;}}}function getSessionMinutes(){if(!sessionStartTime)return 0;return Math.floor((Date.now()-sessionStartTime)/60000);}function showWisdomModal(level){modalOpen=true;const msg=messages[level];const overlay=document.createElement('div');overlay.id='wisdom-modal-overlay';overlay.style.cssText=` position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:10000;animation:wisdomFadeIn 0.3s ease;`;const modal=document.createElement('div');modal.style.cssText=` background:linear-gradient(135deg,#252940 0%,#1a1d2e 100%);border:2px solid #4a7c9c;border-radius:20px;padding:2.5rem;max-width:500px;width:90%;text-align:center;position:relative;animation:wisdomSlideUp 0.4s ease;`;const sessionMinutes=getSessionMinutes();modal.innerHTML=`<style>@keyframes wisdomFadeIn{from{opacity:0;}to{opacity:1;}}@keyframes wisdomSlideUp{from{transform:translateY(30px);opacity:0;}to{transform:translateY(0);opacity:1;}}.wisdom-btn{padding:1rem 2rem;border-radius:10px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s;border:none;}.wisdom-btn:hover{transform:translateY(-2px);}.wisdom-btn-primary{background:#10b981;color:white;}.wisdom-btn-primary:hover{background:#059669;}.wisdom-btn-secondary{background:#3d4466;color:#e2e8f0;}.wisdom-btn-secondary:hover{background:#4d5476;}</style><div style="font-size:4rem;margin-bottom:1rem;">üèõÔ∏è</div><h2 style="color:#4a7c9c;font-size:1.8rem;margin-bottom:0.5rem;">${msg.title}</h2><p style="color:#94a3b8;font-size:0.9rem;margin-bottom:1.5rem;">${ui.timerLabel}:<strong style="color:#e2e8f0;">${sessionMinutes}${ui.minutes}</strong></p><p style="color:#e2e8f0;font-size:1.1rem;margin-bottom:1rem;line-height:1.6;">${msg.message}</p><p style="color:#94a3b8;font-size:1rem;margin-bottom:1.5rem;">${msg.suggestion}</p>${msg.reward ? `<div style="background:rgba(16,185,129,0.1);border:1px solid #10b981;border-radius:8px;padding:0.75rem;margin-bottom:1.5rem;"><span style="color:#10b981;font-weight:600;">${msg.reward}</span></div>`:''}<div style="display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;"><button class="wisdom-btn wisdom-btn-primary" id="wisdom-break-btn">${ui.takeBreak}</button>${msg.canDismiss ? `<button class="wisdom-btn wisdom-btn-secondary" id="wisdom-continue-btn">${ui.continueTraining}</button>`:''}</div>`;overlay.appendChild(modal);document.body.appendChild(overlay);document.getElementById('wisdom-break-btn').addEventListener('click',()=>{handleBreak(level,msg.xpBonus);});const continueBtn=document.getElementById('wisdom-continue-btn');if(continueBtn){continueBtn.addEventListener('click',()=>{handleContinue(level);});}}function handleBreak(level,xpBonus){if(xpBonus>0){const currentXP=parseInt(localStorage.getItem('totalXP')||'0');localStorage.setItem('totalXP',currentXP+xpBonus);alert(ui.xpAwarded(xpBonus));}closeModal();alert(ui.breakTaken);resetSession();}function handleContinue(level){const dismissedLevels=JSON.parse(sessionStorage.getItem('wisdomDismissed')||'[]');if(!dismissedLevels.includes(level)){dismissedLevels.push(level);sessionStorage.setItem('wisdomDismissed',JSON.stringify(dismissedLevels));}closeModal();}function closeModal(){const overlay=document.getElementById('wisdom-modal-overlay');if(overlay){overlay.remove();}modalOpen=false;}function resetSession(){sessionStartTime=Date.now();sessionStorage.setItem('wisdomSessionStart',sessionStartTime);sessionStorage.removeItem('wisdomDismissed');lastNotificationLevel=null;}window.WisdomTracker={init:init,getSessionMinutes:getSessionMinutes,resetSession:resetSession,showModal:showWisdomModal,isGerman:isGerman};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{init();}})();